<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="icon" href="/favicon.png" />
    <link
      href="https://api.fontshare.com/v2/css?f[]=satoshi@700,900,400&display=swap"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="/src/style.css" />
    <title>Pong | Jones Jankovic</title>
  </head>
  <body>
    <header-component class="main-header" id="navbar">
      <div class="nav-container">
        <div class="nav-left">
          <a href="/" class="nav-name-link">
            <span class="nav-name">Jones Jankovic</span>
          </a>
          <div class="glass-nav">
            <a href="/" class="glass-btn">Home</a>
            <a href="/games/" class="glass-btn">Games</a>
          </div>
        </div>

        <div class="nav-right">
          <a
            href="https://discord.com/users/1378992101970280471"
            target="_blank"
            class="nav-icon discord-icon"
          >
            <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
              <path
                d="M18.59 5.88997C17.36 5.31997 16.05 4.89997 14.67 4.65997C14.5 4.95997 14.3 5.36997 14.17 5.69997C12.71 5.47997 11.26 5.47997 9.83001 5.69997C9.69001 5.36997 9.49001 4.95997 9.32001 4.65997C7.94001 4.89997 6.63001 5.31997 5.40001 5.88997C2.92001 9.62997 2.25001 13.28 2.58001 16.87C4.23001 18.1 5.82001 18.84 7.39001 19.33C7.78001 18.8 8.12001 18.23 8.42001 17.64C7.85001 17.43 7.31001 17.16 6.80001 16.85C6.94001 16.75 7.07001 16.64 7.20001 16.54C10.33 18 13.72 18 16.81 16.54C16.94 16.65 17.07 16.75 17.21 16.85C16.7 17.16 16.15 17.42 15.59 17.64C15.89 18.23 16.23 18.8 16.62 19.33C18.19 18.84 19.79 18.1 21.43 16.87C21.82 12.7 20.76 9.08997 18.61 5.88997H18.59ZM8.84001 14.67C7.90001 14.67 7.13001 13.8 7.13001 12.73C7.13001 11.66 7.88001 10.79 8.84001 10.79C9.80001 10.79 10.56 11.66 10.55 12.73C10.55 13.79 9.80001 14.67 8.84001 14.67ZM15.15 14.67C14.21 14.67 13.44 13.8 13.44 12.73C13.44 11.66 14.19 10.79 15.15 10.79C16.11 10.79 16.87 11.66 16.86 12.73C16.86 13.79 16.11 14.67 15.15 14.67Z"
                fill="white"
              ></path>
            </svg>
          </a>

          <a
            href="https://github.com/Jones8683"
            target="_blank"
            class="nav-icon github-icon"
          >
            <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
              <path
                d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.041-1.416-4.041-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"
                fill="white"
              ></path>
            </svg>
          </a>
        </div>
      </div>
    </header-component>

    <main
      style="
        display: flex;
        flex-direction: column;
        align-items: center;
        min-height: 100vh;
        width: 100%;
        text-align: center;
        background: transparent;
      "
    >
      <style>
        .game-wrapper {
          display: flex;
          gap: 30px;
          align-items: flex-start;
          justify-content: center;
          margin-top: -20px;
        }

        .left-section {
          position: relative;
          padding: 12px;
          background: #1a1a1a;
          border: 1px solid rgba(255, 255, 255, 0.1);
          border-radius: 16px;
          box-shadow: 0 25px 60px rgba(0, 0, 0, 0.6);
          width: 724px;
          height: 524px;
          display: flex;
          align-items: center;
          justify-content: center;
        }

        .right-section {
          display: flex;
          flex-direction: column;
          gap: 15px;
          width: 220px;
          text-align: left;
        }

        .game-title {
          font-size: 72px;
          margin: 0 0 10px 0;
          letter-spacing: -4px;
          font-weight: 900;
          color: white;
          line-height: 1;
          text-align: left;
        }

        canvas {
          background-color: #0d0d0d;
          border-radius: 8px;
          display: block;
          box-shadow: inset 0 0 40px rgba(0, 0, 0, 0.5);
          border: 1px solid #333;
        }

        .info-box {
          background: rgba(255, 255, 255, 0.05);
          border: 1px solid rgba(255, 255, 255, 0.1);
          border-radius: 12px;
          padding: 10px;
          display: flex;
          flex-direction: column;
          align-items: center;
          justify-content: center;
          width: 100%;
        }

        .score-box {
          min-height: 100px;
          background: linear-gradient(
            135deg,
            rgba(255, 215, 0, 0.05),
            rgba(255, 215, 0, 0.01)
          );
          border: 1px solid rgba(255, 215, 0, 0.3);
          box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
        }

        .label {
          font-size: 10px;
          color: #94a3b8;
          text-transform: uppercase;
          letter-spacing: 1px;
          margin-bottom: 8px;
          width: 100%;
          text-align: center;
          font-weight: 700;
        }

        .score-label {
          color: #ffd700;
          margin-bottom: 4px;
        }

        .score-value {
          font-size: 42px;
          color: #fff;
          font-weight: 900;
          text-shadow: 0 0 20px rgba(255, 215, 0, 0.2);
        }

        .controls-container {
          margin-top: 5px;
          padding: 0 5px;
        }

        .control-item {
          display: flex;
          justify-content: space-between;
          align-items: center;
          font-size: 11px;
          color: #64748b;
          margin-bottom: 6px;
          border-bottom: 1px solid rgba(255, 255, 255, 0.03);
          padding-bottom: 4px;
        }
        .control-item:last-child {
          border-bottom: none;
        }

        .key {
          color: #fff;
          font-weight: 700;
          background: rgba(255, 255, 255, 0.1);
          padding: 2px 6px;
          border-radius: 4px;
          font-size: 10px;
          min-width: 18px;
          text-align: center;
          display: inline-block;
        }

        .overlay {
          display: none;
          position: absolute;
          top: 0;
          left: 0;
          width: 100%;
          height: 100%;
          background: rgba(0, 0, 0, 0.85);
          flex-direction: column;
          align-items: center;
          justify-content: center;
          z-index: 10;
          border-radius: 16px;
        }

        .menu-title {
          font-size: 32px;
          color: white;
          margin: 0 0 20px 0;
          letter-spacing: 2px;
          font-weight: 900;
        }

        .menu-btn {
          background: white;
          color: black;
          border: none;
          padding: 12px 24px;
          font-weight: 800;
          cursor: pointer;
          border-radius: 4px;
          font-size: 14px;
          text-transform: uppercase;
          letter-spacing: 1px;
          margin: 5px;
          min-width: 140px;
          transition: transform 0.1s;
        }

        .menu-btn:hover {
          transform: scale(1.05);
          background: #eee;
        }

        .mobile-msg {
          display: none;
        }
        .desktop-game {
          display: block;
        }

        @media (max-width: 900px) {
          .desktop-game {
            display: none !important;
          }
          .mobile-msg {
            display: flex !important;
            flex-direction: column;
            align-items: center;
            width: 100%;
            text-align: center;
            padding: 0 20px;
          }
        }
      </style>

      <div class="mobile-msg">
        <div class="content-wrap">
          <h1
            class="name-title"
            style="
              font-size: 24px;
              margin-bottom: 24px;
              letter-spacing: -2px;
              margin-top: 40px;
              width: 100%;
            "
          >
            Not supported on mobile
          </h1>
          <a
            href="/games/"
            class="repo-link"
            style="
              margin-top: 20px;
              font-size: 16px;
              display: inline-block;
              color: lightskyblue;
              text-decoration: none;
            "
          >
            ← Back to games
          </a>
        </div>
      </div>

      <div class="desktop-game">
        <div class="game-wrapper">
          <div class="left-section">
            <canvas id="gameCanvas" width="700" height="500"></canvas>

            <div id="startScreen" class="overlay" style="display: flex">
              <h2 class="menu-title">PONG</h2>
              <button class="menu-btn" onclick="initGame('cpu')">
                1 PLAYER
              </button>
              <button class="menu-btn" onclick="initGame('pvp')">
                2 PLAYERS
              </button>
            </div>

            <div id="gameOverMsg" class="overlay">
              <h2 class="menu-title">GAME OVER</h2>
              <div
                style="color: #94a3b8; margin-bottom: 20px; font-size: 14px"
                id="winnerName"
              >
                PLAYER 1 WINS
              </div>
              <button class="menu-btn" onclick="showStartScreen()">MENU</button>
            </div>

            <div
              id="pauseMsg"
              class="overlay"
              style="background: rgba(0, 0, 0, 0.6)"
            >
              <h2 class="menu-title">PAUSED</h2>
            </div>
          </div>

          <div class="right-section">
            <h1 class="game-title">Pong</h1>

            <div class="info-box score-box">
              <div class="label score-label">Score</div>
              <div class="value score-value" id="scoreDiv">0 - 0</div>
            </div>

            <div class="controls-container">
              <div class="control-item">
                <span>Left Paddle</span>
                <div><span class="key">W</span> <span class="key">S</span></div>
              </div>
              <div class="control-item">
                <span>Right Paddle</span>
                <div><span class="key">↑</span> <span class="key">↓</span></div>
              </div>
              <div class="control-item">
                <span>Pause</span> <span class="key">P</span>
              </div>
            </div>
          </div>
        </div>
      </div>

      <script>
        const canvas = document.getElementById("gameCanvas");
        const ctx = canvas.getContext("2d");
        const scoreDiv = document.getElementById("scoreDiv");
        const startScreen = document.getElementById("startScreen");
        const gameOverMsg = document.getElementById("gameOverMsg");
        const pauseMsg = document.getElementById("pauseMsg");
        const winnerNameDiv = document.getElementById("winnerName");

        const WIN_SCORE = 7;
        const PADDLE_W = 12;
        const PADDLE_H = 85;
        const BALL_SIZE = 8;

        let gameMode = "cpu";
        let animationId;
        let isPaused = false;
        let isRunning = false;
        let isResetting = false;

        const leftPaddle = {
          x: 20,
          y: 210,
          score: 0,
          dy: 0,
          speed: 7,
          aiSpeed: 6,
        };

        const rightPaddle = {
          x: 668,
          y: 210,
          score: 0,
          dy: 0,
          speed: 7,
        };

        const ball = {
          x: 350,
          y: 250,
          dx: 3,
          dy: 3,
          speed: 4,
          baseSpeed: 4,
        };

        function showStartScreen() {
          isRunning = false;
          cancelAnimationFrame(animationId);
          gameOverMsg.style.display = "none";
          pauseMsg.style.display = "none";
          startScreen.style.display = "flex";

          leftPaddle.score = 0;
          rightPaddle.score = 0;
          scoreDiv.innerText = "0 - 0";
        }

        function initGame(mode) {
          gameMode = mode;
          leftPaddle.score = 0;
          rightPaddle.score = 0;

          startScreen.style.display = "none";
          gameOverMsg.style.display = "none";
          pauseMsg.style.display = "none";

          scoreDiv.innerText = "0 - 0";

          isRunning = true;
          isPaused = false;

          resetPositions();
          gameLoop();
        }

        function resetPositions() {
          ball.x = canvas.width / 2;
          ball.y = canvas.height / 2;
          ball.speed = ball.baseSpeed;
          ball.dx = 0;
          ball.dy = 0;

          leftPaddle.y = canvas.height / 2 - PADDLE_H / 2;
          rightPaddle.y = canvas.height / 2 - PADDLE_H / 2;

          isResetting = true;

          setTimeout(() => {
            if (!isRunning) return;
            isResetting = false;
            ball.dx = (Math.random() > 0.5 ? 1 : -1) * ball.speed;
            ball.dy = (Math.random() > 0.5 ? 1 : -1) * ball.speed;
          }, 1000);
        }

        function togglePause() {
          if (!isRunning) return;
          isPaused = !isPaused;
          pauseMsg.style.display = isPaused ? "flex" : "none";
        }

        function update() {
          if (isPaused) return;

          if (gameMode === "cpu") {
            let center = leftPaddle.y + PADDLE_H / 2;
            if (center < ball.y - 10) {
              leftPaddle.y += leftPaddle.aiSpeed;
            } else if (center > ball.y + 10) {
              leftPaddle.y -= leftPaddle.aiSpeed;
            }
          } else {
            leftPaddle.y += leftPaddle.dy;
          }

          if (leftPaddle.y < 0) leftPaddle.y = 0;
          if (leftPaddle.y + PADDLE_H > canvas.height)
            leftPaddle.y = canvas.height - PADDLE_H;

          rightPaddle.y += rightPaddle.dy;
          if (rightPaddle.y < 0) rightPaddle.y = 0;
          if (rightPaddle.y + PADDLE_H > canvas.height)
            rightPaddle.y = canvas.height - PADDLE_H;

          if (!isResetting) {
            ball.x += ball.dx;
            ball.y += ball.dy;
          }

          if (ball.y - BALL_SIZE < 0 || ball.y + BALL_SIZE > canvas.height) {
            ball.dy *= -1;
          }

          let paddle = ball.x < canvas.width / 2 ? leftPaddle : rightPaddle;

          if (collision(ball, paddle)) {
            let collidePoint = ball.y - (paddle.y + PADDLE_H / 2);
            collidePoint = collidePoint / (PADDLE_H / 2);

            let angleRad = (Math.PI / 4) * collidePoint;
            let direction = ball.x < canvas.width / 2 ? 1 : -1;

            ball.speed += 0.5;

            ball.dx = direction * ball.speed * Math.cos(angleRad);
            ball.dy = ball.speed * Math.sin(angleRad);
          }

          if (ball.x < 0) {
            rightPaddle.score++;
            scoreDiv.innerText = `${leftPaddle.score} - ${rightPaddle.score}`;
            checkWin();
            if (isRunning) resetPositions();
          } else if (ball.x > canvas.width) {
            leftPaddle.score++;
            scoreDiv.innerText = `${leftPaddle.score} - ${rightPaddle.score}`;
            checkWin();
            if (isRunning) resetPositions();
          }
        }

        function checkWin() {
          if (leftPaddle.score >= WIN_SCORE || rightPaddle.score >= WIN_SCORE) {
            isRunning = false;
            let winnerName = "";

            if (gameMode === "cpu") {
              winnerName =
                rightPaddle.score >= WIN_SCORE ? "YOU WIN!" : "COMPUTER WINS!";
            } else {
              winnerName =
                leftPaddle.score >= WIN_SCORE
                  ? "LEFT PLAYER WINS!"
                  : "RIGHT PLAYER WINS!";
            }

            winnerNameDiv.innerText = winnerName;
            gameOverMsg.style.display = "flex";
          }
        }

        function collision(b, p) {
          return (
            b.x + BALL_SIZE > p.x &&
            b.x - BALL_SIZE < p.x + PADDLE_W &&
            b.y + BALL_SIZE > p.y &&
            b.y - BALL_SIZE < p.y + PADDLE_H
          );
        }

        function draw() {
          ctx.fillStyle = "#0d0d0d";
          ctx.fillRect(0, 0, canvas.width, canvas.height);

          ctx.fillStyle = "#333";
          for (let i = 0; i < canvas.height; i += 30) {
            ctx.fillRect(canvas.width / 2 - 1, i, 2, 20);
          }

          ctx.fillStyle = "white";

          ctx.beginPath();
          ctx.roundRect(leftPaddle.x, leftPaddle.y, PADDLE_W, PADDLE_H, 4);
          ctx.fill();

          ctx.beginPath();
          ctx.roundRect(rightPaddle.x, rightPaddle.y, PADDLE_W, PADDLE_H, 4);
          ctx.fill();

          ctx.beginPath();
          ctx.arc(ball.x, ball.y, BALL_SIZE, 0, Math.PI * 2);
          ctx.fill();
        }

        function gameLoop() {
          if (isRunning) {
            update();
            draw();
            animationId = requestAnimationFrame(gameLoop);
          }
        }

        window.addEventListener(
          "keydown",
          function (e) {
            if (["ArrowUp", "ArrowDown", "Space"].indexOf(e.code) > -1) {
              e.preventDefault();
            }
          },
          false,
        );

        document.addEventListener("keydown", (e) => {
          if (e.key.toLowerCase() === "p") {
            togglePause();
            return;
          }

          if (e.key === "w" || e.key === "W") leftPaddle.dy = -leftPaddle.speed;
          if (e.key === "s" || e.key === "S") leftPaddle.dy = leftPaddle.speed;

          if (e.key === "ArrowUp") rightPaddle.dy = -rightPaddle.speed;
          if (e.key === "ArrowDown") rightPaddle.dy = rightPaddle.speed;
        });

        document.addEventListener("keyup", (e) => {
          if (["w", "W", "s", "S"].includes(e.key)) {
            leftPaddle.dy = 0;
          }
          if (["ArrowUp", "ArrowDown"].includes(e.key)) {
            rightPaddle.dy = 0;
          }
        });

        draw();
      </script>
    </main>

    <footer class="main-footer">
      <div class="footer-line"></div>
      <p>&copy; 2026 Jones Jankovic</p>
    </footer>
    <script src="/src/main.js" type="module"></script>
  </body>
</html>
